<div class="w-full h-full bg-gray-100 dark:bg-night-700 relative">
  <div class="px-8 bg-gray-100 dark:bg-night-700">
    <div class="flex space-x-12 py-4 sticky top-0 items-center bg-gray-100 dark:bg-night-700">
      @if (loadError == false) {
        <svp-status-card [status]="project.status" />
      
        <div class="flex flex-col space-y-1">
          <p svp-text>Project created</p>
          <h1 svp-subHeader>{{ project.startDate | date:'MMM dd, yyyy' }}</h1>
        </div>
        
        <div class="flex flex-col space-y-1">
          <p svp-text>Project created</p>
          <!-- Add created date to API response -->
          <h1 svp-subHeader>{{ project.startDate | date:'MMM dd, yyyy'}}</h1>
        </div>
      
        <div class="flex flex-col space-y-1">
          <p svp-text>Project Manager</p>
          <h1 svp-subHeader>{{ project.assignee ? project.assignee.fullName : 'N/A' }}</h1>
        </div>
      }

      <div class="self-start grow flex justify-end -mr-4 cursor-pointer text-gray-800 dark:text-night-200 hover:text-gray-500 dark:hover:text-night-400">
        <svg-icon src="assets/icons/appicons/cancel.svg" [svgClass]="'h-5 w-5'" (click)="close()"/>
      </div>
    </div>

    <div *ngIf="loadError === undefined">
      <div class="w-44 h-full m-auto">
        <h1 svp-subHeader>Loading...</h1>
      </div>
    </div>

    <div *ngIf="loadError === true">
      <div class="w-96 h-full m-auto">
        <h1 class="text-red-600">An unexpected error occurred while fetching the project details.</h1>
      </div>
    </div>

    <div *ngIf="loadError === false">
      <div class="my-4 space-y-3">
        <h1 svp-header>{{ project.title }}</h1>
        <p svp-text>{{ project.description }}</p>
      </div>

      <div class="bg-white dark:bg-night-500 p-8 rounded-xl">
        <div class="grid grid-cols-2">
          <div class="space-y-4">

            <!-- TASKS -->
            <div class="flex space-x-2 items-center">      
              <svg-icon src="assets/icons/appicons/bar-chart.svg" [svgClass]="'h-5 w-5 dark:text-gray-200'"/>
              <h1 svp-subHeader>Tasks</h1>
            </div>

            <p svp-text italic *ngIf="true">No tasks created yet</p>
            
            <!-- TODO: display the first three active tasks here -->
            <!-- <div class="flex space-x-2 items-center">      
              <input type="checkbox" checked disabled>
              <p svp-text>Site Clearing</p>
            </div>

            <div class="flex space-x-2 items-center">      
              <input type="checkbox" disabled>
              <p svp-text>Foundation</p>
            </div>  

            <div class="flex space-x-2 items-center">
              <input type="checkbox" disabled>
              <p svp-text>Roofing</p>
            </div>

            <div class="flex space-x-2 items-center">
              <input type="checkbox" disabled>
              <p svp-text>Finishing</p>
            </div> -->

            <!-- ATTACHMENTS -->
            <div class="flex space-x-2 items-center pt-10">      
              <svg-icon src="assets/icons/appicons/bar-chart.svg" [svgClass]="'h-5 w-5 dark:text-gray-200'"/>
              <h1 svp-subHeader>Attachments</h1>
            </div>

            <div class="flex space-x-2 items-center" *ngIf="project.design">
              <svg-icon src="assets/icons/appicons/chart.svg" [svgClass]="'h-5 w-5 dark:text-gray-200'"/>
              <p svp-text>{{project.design!.name}}</p>
            </div>
          </div>

          <div class="space-y-4">
            <!-- RECENT ACTIVITIES -->
            <div class="ml-6">      
              <h1 svp-subHeader>Recent Activities</h1>
              <p svp-text italic *ngIf="true" class="mt-2">No recent activities</p>
            </div>

            <!-- TODO: implement project activities to include creating tasks, assigning tasks, updating tasks, assigning project to PM, etc. -->
            
            
            <!-- <ol class="relative border-s border-gray-200 dark:border-gray-700">                  
              <li class="ms-6">            
                  <span class="absolute flex items-center justify-center w-6 h-6 bg-gray-100 rounded-full -start-3 ring-8 ring-white dark:ring-gray-900 dark:bg-blue-900">
                    <svg-icon src="assets/icons/appicons/check-mark.svg" [svgClass]="'h-3 w-3 text-gray-900'"/>
                  </span>
                  <h1 svp-subHeader>Admin assigned task to James Sylvester</h1>
                  <time class="block mb-2 text-sm font-normal leading-none text-gray-400 dark:text-gray-500">January 13th, 2024</time>
              </li>
              <li class="mt-10 ms-6">
                <span class="absolute flex items-center justify-center w-6 h-6 bg-gray-100 rounded-full -start-3 ring-8 ring-white dark:ring-gray-900 dark:bg-blue-900">
                  <svg-icon src="assets/icons/appicons/check-mark.svg" [svgClass]="'h-3 w-3 text-gray-900'"/>
                </span>
                <h1 svp-subHeader>Task Created - Ground breaking</h1>
                <time class="block mb-2 text-sm font-normal leading-none text-gray-400 dark:text-gray-500">February 13th, 2024</time>
              </li>
              <li class="mt-10 ms-6">
                <span class="absolute flex items-center justify-center w-6 h-6 bg-gray-100 rounded-full -start-3 ring-8 ring-white dark:ring-gray-900 dark:bg-blue-900">
                  <svg-icon src="assets/icons/appicons/check-mark.svg" [svgClass]="'h-3 w-3 text-gray-900'"/>
                </span>
                <h1 svp-subHeader>Ground breaking assigned to James Sylvester</h1>
                <time class="block mb-2 text-sm font-normal leading-none text-gray-400 dark:text-gray-500">March 13th, 2024</time>
              </li>
            </ol> -->
          </div>
        </div>
      </div>
    </div>
    
    <div class="flex justify-between mt-6 py-3 px-8 -mx-8 space-x-6 bg-gray-100 border-t-2 border-gray-200 dark:bg-night-700 sticky bottom-0" *ngIf="loadError === false && !project.assignee">
      <div class="mb-5">
        <label svp-label>Assign to PM</label>
        <ng-select [items]="projectManagers$ | async"
            [addTag]="false"
            [multiple]="false"
            [hideSelected]="false"
            placeholder="-- select manager --"
            bindLabel="name"
            bindValue="uid"
            [loading]="projectManagersLoading"
            [(ngModel)]="selectedProjectManagerUid"
            [typeahead]="projectManagerInput$"
            typeToSearchText="Please enter 2 or more characters"
            class="min-w-56 max-w-72">
        </ng-select>
      </div>

      <div class="grow flex space-x-2 justify-end">
        <button class="hover:underline dark:text-night-100 mr-1" (click)="close()">Cancel</button>
        <button svp-neutral>Reject Project</button>
        <button svp-primary (click)="assignProjectManager()">Approve Project</button>
      </div>
    </div>
  </div>
</div>